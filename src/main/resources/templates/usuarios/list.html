<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Usuários - Lista</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" th:href="@{/css/list.css}">
    <script defer th:src="@{/js/list.js}"></script>
</head>
<body class="page">

<div th:replace="fragments/layout :: header('Usuários')"></div>

<main class="wrapper">

    <div th:if="${msg != null and msg != ''}"
        class="alert alert--success alert--auto"
        th:text="${msg}">
    </div>
    <div class="actions-bar">
        <div class="actions-bar__left">
            <a th:href="@{/usuarios/ui/novo}" class="btn btn--primary">Novo Usuário</a>
            <a th:href="@{/usuarios}" class="btn btn--ghost" title="Ver endpoint JSON da API">API JSON</a>
            <a th:href="@{/usuarios/ui/buscar}" class="btn btn--ghost">Pesquisar</a>
            <a th:href="@{/usuarios/ui/exportar}" class="btn btn--ghost" title="Exportar CSV">Exportar CSV</a>
        </div>
    </div>

    <div class="toast" id="toast" hidden></div>

    <div class="card table-card" th:if="${usuarios != null}">
        <div class="table-wrapper" th:if="${#lists.size(usuarios) > 0}">
            <table class="data-table">
                <thead>
                <tr>
                    <th>CPF</th>
                    <th>Nome</th>
                    <th>Data Nasc.</th>
                    <th>CEP</th>
                    <th>Placa</th>
                    <th style="min-width:140px;">Ações</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="u : ${usuarios}" th:attr="data-cpf=${u.cpf}">
                    <td data-label="CPF" th:text="${u.cpf}">12345678909</td>
                    <td data-label="Nome" th:text="${u.nome}">Nome</td>
                    <td data-label="Data Nasc." th:text="${#dates.format(u.dataNascimento, 'yyyy-MM-dd')}">1990-01-01</td>
                    <td data-label="CEP" th:text="${u.endereco != null ? u.endereco.cep : ''}">00000000</td>
                    <td data-label="Placa">
                        <span th:if="${u.placa != null}" class="badge badge--plate" th:text="${u.placa.placa}">ABC1234</span>
                        <span th:if="${u.placa == null}" class="badge badge--empty">Sem placa</span>
                    </td>
                    <td class="row-actions">
                        <a th:href="@{'/usuarios/ui/' + ${u.cpf} + '/editar'}" class="btn btn--ghost btn--xs">Editar</a>
                        <button type="button"
                                class="btn btn--danger btn--xs js-delete-user"
                                th:attr="data-cpf=${u.cpf}">
                            Excluir
                        </button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <div class="empty-state" th:if="${#lists.size(usuarios) == 0}">
            Nenhum usuário encontrado.
        </div>
    </div>

</main>

</body>
</html>